(window.webpackJsonp=window.webpackJsonp||[]).push([[202],{585:function(t,e,n){"use strict";n.r(e);var s=n(10),r=Object(s.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[e("p",[this._v("Just a quick MySQL test on how to use UTF8 encoding with JDBC connection string. Also a test on how to set TIMESTAMP default values.")]),this._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('package zemian.jdbc;\n\nimport org.junit.Test;\n\nimport java.sql.*;\nimport java.util.*;\nimport java.util.Date;\n\n/**\n\n -- drop table ztest_issues;\n CREATE TABLE ztest_issues(\n id INT NOT NULL AUTO_INCREMENT PRIMARY KEY\n , title VARCHAR(64) NOT NULL\n , summary TEXT NULL\n , priority INT NOT NULL DEFAULT 5\n , cdate DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP\n );\n\n INSERT INTO ztest_issues(title) VALUES(\'test\');\n INSERT INTO ztest_issues(title, summary) VALUES(\'test2\', \'Just a test\');\n INSERT INTO ztest_issues(title, summary, priority) VALUES(\'test2\', \'Just a test\', 1);\n INSERT INTO ztest_issues(title, summary, priority, cdate) VALUES(\'test2\', \'Just a test\', 1, \'2010-12-31 08:00:00\');\n\n --INSERT INTO ztest_issues(title, summary) VALUES(\'locale test1\', LOAD_FILE(\'C:/data/tmp/test.xml\'));\n --INSERT INTO ztest_issues(title, summary) VALUES(\'locale test2\', LOAD_FILE(\'C:/data/tmp/test2.xml\'));\n --INSERT INTO ztest_issues(title, summary) VALUES(\'locale test3\', LOAD_FILE(\'C:/data/tmp/test3.xml\'));\n\n SELECT * FROM ztest_issues;\n\n NOTE:\n CURRENT_TIMESTAMP is version specific and is now allowed for DATETIME columns as of version 5.6 http://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html\n\n For 5.6 <, use TIMESTAMP for cdate field instead.\n\n cdate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n cdate DATETIME NULL\n\n NOTE2:\n cdate DATETIME NOT NULL DEFAULT 0\n\n If you were to use default to ZERO, then you would need this properties in conn string. Else you will fail to get ZERO date value into Java.\n\n You need to tell the JDBC driver to convert them to NULL. This is done by passing a connection property name zeroDateTimeBehavior with the value convertToNull\n\n For more details see the manual: http://dev.mysql.com/doc/refman/4.1/en/connector-j-installing-upgrading.html\n\n */\npublic class ZtestIssuesJdbcTest {\n//    String url = "jdbc:mysql://localhost/test";\n//    String url = "jdbc:mysql://localhost/test?zeroDateTimeBehavior=convertToNull";\n    String url = "jdbc:mysql://localhost/test?useUnicode=true&characterEncoding=UTF-8&connectionCollation=utf8_general_ci&zeroDateTimeBehavior=convertToNull";\n    String username = "test";\n    String password = "test123";\n\n    @Test\n    public void testShowTableLocale() throws Exception {\n        try (Connection conn = DriverManager.getConnection(url, username, password)) {\n            String sql = "SHOW VARIABLES LIKE \'char%\'";\n            System.out.println("Sql:" + sql);\n            Statement sm = conn.createStatement();\n            ResultSet rs = sm.executeQuery(sql);\n            while (rs.next()) {\n                System.out.printf("%s\\t%s\\n", rs.getObject(1), rs.getObject(2));\n            }\n\n            sql = "SHOW CREATE TABLE ztest_issues";\n            System.out.println("Sql:" + sql);\n            sm = conn.createStatement();\n            rs = sm.executeQuery(sql);\n            while (rs.next()) {\n                System.out.printf("%s\\t%s\\n", rs.getObject(1), rs.getObject(2));\n            }\n        }\n    }\n\n    @Test\n    public void testQuery() throws Exception {\n        try (Connection conn = DriverManager.getConnection(url, username, password)) {\n            String sql = "SELECT id, cdate, title, summary FROM ztest_issues";\n            System.out.println("Sql:" + sql);\n            Statement sm = conn.createStatement();\n            ResultSet rs = sm.executeQuery(sql);\n            while (rs.next()) {\n                System.out.printf("%d\\t%s\\t%s\\t%s\\n", rs.getObject(1), rs.getObject(2), rs.getObject(3), rs.getObject(4));\n            }\n        }\n    }\n\n    @Test\n    public void testInsert() throws Exception {\n        try (Connection conn = DriverManager.getConnection(url, username, password)) {\n            String sql = "INSERT INTO ztest_issues(title, summary, cdate) VALUES(?, ?, ?)";\n            System.out.println("Sql: " + sql);\n            PreparedStatement ps = conn.prepareStatement(sql);\n\n            String testId = "" + System.currentTimeMillis();\n\n            ps.setObject(1, "English Locale " + testId);\n            ps.setObject(2, "Just a test");\n            ps.setObject(3, new Date());\n            int result = ps.executeUpdate();\n            System.out.println("Insert Result: " + result);\n\n            ps.setObject(1, "Chinese Locale " + testId);\n            ps.setObject(2, "&#21482;&#26159;&#19968;&#20491;&#28204;&#35430;");\n            ps.setObject(3, new Date());\n            result = ps.executeUpdate();\n            System.out.println("Insert Result: " + result);\n\n            ps.setObject(1, "Spanish Locale " + testId);\n            ps.setObject(2, "SÃ³lo una prueba");\n            ps.setObject(3, new Date());\n            result = ps.executeUpdate();\n            System.out.println("Insert Result: " + result);\n        }\n    }\n}\n')])])])])}),[],!1,null,null,null);e.default=r.exports}}]);