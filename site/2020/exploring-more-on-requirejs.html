<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Exploring More on RequireJS</title>
        <link rel="stylesheet" href="https://zemian.github.io/theme/css/main.css" />
        <link href="https://zemian.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="ZBlog Atom Feed" />
        <meta name="description" content="Configuring RequireJS You can use either requirejs.config() or require.config() to setup RequireJS. I preferred the requirejs.config() and..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://zemian.github.io/">ZBlog</a></h1>
                <nav><ul>
                    <li><a href="https://zemian.github.io/pages/about-the-author.html">About The Author</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://zemian.github.io/2020/exploring-more-on-requirejs.html" rel="bookmark"
           title="Permalink to Exploring More on RequireJS">Exploring More on RequireJS</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2020-04-22T00:00:00-05:00">
                Published: Wed 22 April 2020
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://zemian.github.io/author/zemian-deng.html">Zemian Deng</a>
        </address>
<p>In <a href="https://zemian.github.io/category/blog.html">Blog</a>.</p>
<p>tags: <a href="https://zemian.github.io/tag/requirejs.html">requirejs</a> </p>
</footer><!-- /.post-info -->      <h2>Configuring RequireJS</h2>
<p>You can use either <code>requirejs.config()</code> or <code>require.config()</code> to setup RequireJS. I preferred the <code>requirejs.config()</code> and <code>require()</code> to load modules just so to give them some distinction on usage. A typical config usage is like this:</p>
<div class="highlight"><pre><span></span><code><span class="nx">requirejs</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="nx">baseUrl</span><span class="o">:</span> <span class="s2">&quot;js/&quot;</span><span class="p">,</span>
    <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;foo&#39;</span><span class="o">:</span> <span class="s1">&#39;path/foo&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bar&#39;</span><span class="o">:</span> <span class="s1">&#39;path/bar&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<p>You can actually run <code>requirejs.config()</code> multiple times! Most of the options will be appended together. But the last <code>baseUrl</code> will override all.</p>
<h2>Use Shim for Library that has no AMD support</h2>
<p>If you are loading a library (eg: CKEDITOR4), then you need to work with <code>shim</code> because it expose a global variable named CKEDITOR. Examples:</p>
<div class="highlight"><pre><span></span><code><span class="nx">requirejs</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">ckeditor</span><span class="o">:</span> <span class="s1">&#39;https://cdn.jsdelivr.net/npm/ckeditor4@4.14.0/ckeditor&#39;</span>
    <span class="p">},</span>
    <span class="nx">shims</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">ckeditor</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">exports</span><span class="o">:</span> <span class="s1">&#39;CKEDITOR&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="nx">require</span><span class="p">([</span><span class="s1">&#39;ckeditor&#39;</span><span class="p">],</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Notice that CKEDITOR variable is automatically available due to our shims&#39; export.</span>
    <span class="nx">CKEDITOR</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;editor&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">width</span><span class="o">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="nx">height</span><span class="o">:</span> <span class="s1">&#39;85%&#39;</span><span class="p">});</span>
<span class="p">});</span>
</code></pre></div>

<h2>Writing Modules</h2>
<p>It’s recommended you don’t explicitly name your module, but simply let your filename be the module name. Example:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//file: mymodule.js</span>
<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;mymodule&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">uniqueId</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">).</span><span class="nx">substring</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<p>You can create many internal functions and variable you want and they do need to be all returned (or exported). Another popular export data is simply the JS function constructor. Example:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//file: MyService.js</span>
<span class="nx">define</span><span class="p">([</span><span class="s1">&#39;mylib&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mylib</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">MyService</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ... define your service here.</span>
    <span class="c1">// note that &#39;mylib&#39; is loaded and availabe to use here.</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">MyService</span><span class="p">;</span>
<span class="p">});</span><span class="nx">require</span><span class="p">([</span><span class="s1">&#39;MyService&#39;</span><span class="p">],</span> <span class="p">(</span><span class="nx">MyService</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">service</span> <span class="o">=</span> <span class="ow">new</span> <span class="nx">MyService</span><span class="p">();</span>
  <span class="c1">// Use service here...</span>
<span class="p">});</span>
</code></pre></div>

<h2>Loading Modules</h2>
<p>You should know that when you use <code>require()</code> to load modules, they are all loaded asynchronously, and all the dependency are loaded accordingly in the proper order!</p>
<p>You can configure RequireJS with <code>paths</code> that setup hundreds of ready to use libraries, but if you don’t invoke <code>require()</code>, it will not be loaded into your browser at runtime!</p>
<p>The <code>require()</code> can be use anywhere in your HTML script code. One popular way to organize the code is that you place your application entry file (usually named <code>main.js</code>) with entry point of <code>require()</code> to start your application. Then you can load it in browser like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">data-main</span><span class="o">=</span><span class="s">&quot;main&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/requirejs@2.3.6/require.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>

<p>Note that <code>.js</code> is optional when you use <code>data-main</code> attribute. Above can also be loaded in your old fashion way like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/requirejs@2.3.6/require.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;main.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>

<h2>Troubleshooting Tips</h2>
<ol>
<li>The usage and syntax of <code>require()</code> and <code>define()</code> is the same, so ensure you use the correct one! Using <code>define()</code> instead of <code>require()</code> will obviously fail your application, but the error might not be so straight forward.</li>
<li>RequireJS loads modules in relative to the <code>baseUrl</code> path value setup in your config options. Ensure the value it’s loaded properly. Especially if you are using relative path. It default value is relative to the <code>.html</code> file where you include the <code>require.js</code> file in script tag. Triple check this if you see error not able to find your modules.</li>
<li>The <code>paths</code> configuration option accept value of module with out <code>.js</code> extension! If you include it, it will fail to find your module.</li>
<li>If you have large modules that you use all of the time. Try reduce the number of dependency modules your user need to import by writing a wrapper module.</li>
<li>When loading large dependency module list, use a consistent formatting to help. Also, ensure you match up your array of dependency module names with the function callback parameters correctly. Else you get all sort of weird errors. For example:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nx">require</span><span class="p">([</span><span class="s1">&#39;mymodulelib&#39;</span><span class="p">,</span>
  <span class="s1">&#39;mymodulelib2&#39;</span><span class="p">,</span>
  <span class="s1">&#39;mymodulelib3&#39;</span><span class="p">,</span>
  <span class="s1">&#39;mymodulelib4&#39;</span><span class="p">,</span>
  <span class="s1">&#39;mymodulelib5&#39;</span>
<span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lib</span><span class="p">,</span> <span class="nx">lib2</span><span class="p">,</span> <span class="nx">lib3</span><span class="p">)</span> <span class="p">{</span><span class="c1">// write your module here...});</span>
</code></pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://zemian.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>