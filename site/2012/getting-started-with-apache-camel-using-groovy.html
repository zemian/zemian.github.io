<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Getting started with Apache Camel using Groovy</title>
        <link rel="stylesheet" href="https://zemian.github.io/theme/css/main.css" />
        <link href="https://zemian.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="ZBlog Atom Feed" />
        <meta name="description" content="From their site, it says the Apache Camel is a versatile open-source integration framework based on known Enterprise Integration Patterns. It..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://zemian.github.io/">ZBlog</a></h1>
                <nav><ul>
                    <li><a href="https://zemian.github.io/pages/about-the-author.html">About The Author</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://zemian.github.io/2012/getting-started-with-apache-camel-using-groovy.html" rel="bookmark"
           title="Permalink to Getting started with Apache Camel using Groovy">Getting started with Apache Camel using Groovy</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-08-18T00:00:00-05:00">
                Published: Sat 18 August 2012
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://zemian.github.io/author/zemian-deng.html">Zemian Deng</a>
        </address>
<p>In <a href="https://zemian.github.io/category/blog.html">Blog</a>.</p>
<p>tags: <a href="https://zemian.github.io/tag/groovy.html">groovy</a> <a href="https://zemian.github.io/tag/camel.html">camel</a> </p>
</footer><!-- /.post-info -->      <p>From their site, it says the <a href="http://camel.apache.org">Apache Camel</a> is a versatile open-source integration framework based on known Enterprise Integration Patterns. It might seem like a vague definition, but I want to tell you that this is a very productive Java library that can solve many of typical IT problems! You can think of it as a very light weight ESB framework with "batteries" included.</p>
<p>In every jobs I've been to so far, folks are writing their own solutions in one way or another to solve many common problems (or they would buy some very expensive enterprisy ESB servers that takes months and months to learn, config, and maintain). Things that we commonly solve are integration (glue) code of existing business services together, process data in a certain workflow manner, or move and transform data from one place to another etc. These are very typical need in many IT environments. The Apache Camel can be used in cases like these; not only that, but also in a very productive and effective way!</p>
<p>In this article, I will show you how to get started with Apache Camel along with just few lines of <a href="http://groovy.codehaus.org/">Groovy</a> script. You can certainly also start off with a full Java project to try out Camel, but I find Groovy will give you the shortest working example and learning curve. </p>
<h2>Getting started with Apache Camel using Groovy</h2>
<p>So let's begin. First let's see a hello world demo with Camel + Groovy.</p>
<div class="highlight"><pre><span></span><code>    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.apache.camel:camel-core:2.10.0&#39;</span><span class="p">)</span>
    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.slf4j:slf4j-simple:1.6.6&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.impl.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.builder.</span><span class="o">*</span>

    <span class="k">def</span> <span class="nf">camelContext</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DefaultCamelContext</span><span class="p">()</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">addRoutes</span><span class="p">(</span><span class="n">new</span> <span class="n">RouteBuilder</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">def</span> <span class="nf">void</span> <span class="n">configure</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">from</span><span class="p">(</span><span class="s2">&quot;timer://jdkTimer?period=3000&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;log://camelLogger?level=INFO&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">addShutdownHook</span><span class="p">{</span> <span class="n">camelContext</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span> <span class="p">}</span>
    <span class="n">synchronized</span><span class="p">(</span><span class="n">this</span><span class="p">){</span> <span class="n">this</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="p">}</span>
</code></pre></div>

<p>Save above into a file named <code>helloCamel.groovy</code> and then run it like this:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">groovy</span><span class="w"> </span><span class="n">helloCamel</span><span class="p">.</span><span class="n">groovy</span><span class="w"></span>
<span class="w">    </span><span class="mi">388</span><span class="w"> </span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">camel</span><span class="p">.</span><span class="n">impl</span><span class="p">.</span><span class="n">DefaultCamelContext</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Apache</span><span class="w"> </span><span class="n">Camel</span><span class="w"> </span><span class="mf">2.10.0</span><span class="w"> </span><span class="p">(</span><span class="nl">CamelContext</span><span class="p">:</span><span class="w"> </span><span class="n">camel</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">starting</span><span class="w"></span>
<span class="w">    </span><span class="mi">445</span><span class="w"> </span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">camel</span><span class="p">.</span><span class="n">management</span><span class="p">.</span><span class="n">ManagementStrategyFactory</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">JMX</span><span class="w"> </span><span class="n">enabled</span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="mi">447</span><span class="w"> </span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">camel</span><span class="p">.</span><span class="n">management</span><span class="p">.</span><span class="n">DefaultManagementLifecycleStrategy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">StatisticsLevel</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="ow">All</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">enabling</span><span class="w"> </span><span class="k">load</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="k">statistics</span><span class="w"></span>
<span class="w">    </span><span class="mi">678</span><span class="w"> </span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">camel</span><span class="p">.</span><span class="n">impl</span><span class="p">.</span><span class="n">converter</span><span class="p">.</span><span class="n">DefaultTypeConverter</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Loaded</span><span class="w"> </span><span class="mi">170</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">converters</span><span class="w"></span>
<span class="w">    </span><span class="mi">882</span><span class="w"> </span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">camel</span><span class="p">.</span><span class="n">impl</span><span class="p">.</span><span class="n">DefaultCamelContext</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">Route</span><span class="p">:</span><span class="w"> </span><span class="n">route1</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">consuming</span><span class="w"> </span><span class="k">from</span><span class="err">:</span><span class="w"> </span><span class="n">Endpoint</span><span class="o">[</span><span class="n">timer://jdkTimer?period=3000</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="mi">883</span><span class="w"> </span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">camel</span><span class="p">.</span><span class="n">impl</span><span class="p">.</span><span class="n">DefaultCamelContext</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">routes</span><span class="p">,</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">started</span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="mi">887</span><span class="w"> </span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">camel</span><span class="p">.</span><span class="n">impl</span><span class="p">.</span><span class="n">DefaultCamelContext</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Apache</span><span class="w"> </span><span class="n">Camel</span><span class="w"> </span><span class="mf">2.10.0</span><span class="w"> </span><span class="p">(</span><span class="nl">CamelContext</span><span class="p">:</span><span class="w"> </span><span class="n">camel</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mf">0.496</span><span class="w"> </span><span class="n">seconds</span><span class="w"></span>
<span class="w">    </span><span class="mi">898</span><span class="w"> </span><span class="o">[</span><span class="n">Camel (camel-1) thread #1 - timer://jdkTimer</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">camelLogger</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Exchange</span><span class="o">[</span><span class="n">ExchangePattern:InOnly, BodyType:null, Body:[Body is null</span><span class="o">]</span><span class="err">]</span><span class="w"></span>
<span class="w">    </span><span class="mi">3884</span><span class="w"> </span><span class="o">[</span><span class="n">Camel (camel-1) thread #1 - timer://jdkTimer</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">camelLogger</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Exchange</span><span class="o">[</span><span class="n">ExchangePattern:InOnly, BodyType:null, Body:[Body is null</span><span class="o">]</span><span class="err">]</span><span class="w"></span>
<span class="w">    </span><span class="mi">6884</span><span class="w"> </span><span class="o">[</span><span class="n">Camel (camel-1) thread #1 - timer://jdkTimer</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">camelLogger</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Exchange</span><span class="o">[</span><span class="n">ExchangePattern:InOnly, BodyType:null, Body:[Body is null</span><span class="o">]</span><span class="err">]</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>
</code></pre></div>

<p>The little script above is simple but it presented few key features of Camel Groovyness. The first and last section of the <code>helloCamel.groovy</code> script are just Groovy featuers. The <code>@Grab</code> annotation will automatically download the dependency jars you specify. We import Java packages to use its classes later. At the end we ensure to shutdown Camel before exiting JVM through the Java Shutdown Hook mechanism. The program will sit and wait until user press <code>CTRL+C</code>, just as a typical server process behavior.</p>
<p>The middle section is where the Camel action is. You would always create a Camel context to begin (think of it as the server or manager for the process.) And then you would add a Camel route (think of it as a workflow or pipeflow) that you like to process data (Camel likes to call these data "messages"). The route consists of a "from" starting point (where data generated), and one or more "to" points (where data going to be processed). Camel calls these destination 'points' as 'Endpoints'. These endpoints can be expressed in simple URI string format such as <code>"timer://jdkTimer?period=3000"</code>. Here we are generating timer message in every 3 secs into the pipeflow, and then process by a logger URI, which will simply print to console output.</p>
<p>After Camel context started, it will start processing data through the workflow, as you can observe from the output example above. Now try pressing <code>CTRL+C</code> to end its process. Notice how the Camel will shutdown everything very gracefully.</p>
<div class="highlight"><pre><span></span><code>    <span class="mi">7312</span> [<span class="nv">Thread</span><span class="o">-</span><span class="mi">2</span>] <span class="nv">INFO</span> <span class="nv">org</span>.<span class="nv">apache</span>.<span class="nv">camel</span>.<span class="nv">impl</span>.<span class="nv">DefaultCamelContext</span> <span class="o">-</span> <span class="nv">Apache</span> <span class="nv">Camel</span> <span class="mi">2</span>.<span class="mi">10</span>.<span class="mi">0</span> <span class="ss">(</span><span class="nv">CamelContext</span>: <span class="nv">camel</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">shutting</span> <span class="nv">down</span>
    <span class="mi">7312</span> [<span class="nv">Thread</span><span class="o">-</span><span class="mi">2</span>] <span class="nv">INFO</span> <span class="nv">org</span>.<span class="nv">apache</span>.<span class="nv">camel</span>.<span class="nv">impl</span>.<span class="nv">DefaultShutdownStrategy</span> <span class="o">-</span> <span class="nv">Starting</span> <span class="nv">to</span> <span class="nv">graceful</span> <span class="nv">shutdown</span> <span class="mi">1</span> <span class="nv">routes</span> <span class="ss">(</span><span class="nb">timeout</span> <span class="mi">300</span> <span class="nv">seconds</span><span class="ss">)</span>
    <span class="mi">7317</span> [<span class="nv">Camel</span> <span class="ss">(</span><span class="nv">camel</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span> <span class="nv">thread</span> <span class="sc">#2</span> <span class="o">-</span> <span class="nv">ShutdownTask</span>] <span class="nv">INFO</span> <span class="nv">org</span>.<span class="nv">apache</span>.<span class="nv">camel</span>.<span class="nv">impl</span>.<span class="nv">DefaultShutdownStrategy</span> <span class="o">-</span> <span class="nv">Route</span>: <span class="nv">route1</span> <span class="nv">shutdown</span> <span class="nv">complete</span>, <span class="nv">was</span> <span class="nv">consuming</span> <span class="nv">from</span>: <span class="nv">Endpoint</span>[<span class="nv">timer</span>:<span class="o">//</span><span class="nv">jdkTimer</span>?<span class="nv">period</span><span class="o">=</span><span class="mi">3000</span>]
    <span class="mi">7317</span> [<span class="nv">Thread</span><span class="o">-</span><span class="mi">2</span>] <span class="nv">INFO</span> <span class="nv">org</span>.<span class="nv">apache</span>.<span class="nv">camel</span>.<span class="nv">impl</span>.<span class="nv">DefaultShutdownStrategy</span> <span class="o">-</span> <span class="nv">Graceful</span> <span class="nv">shutdown</span> <span class="nv">of</span> <span class="mi">1</span> <span class="nv">routes</span> <span class="nv">completed</span> <span class="nv">in</span> <span class="mi">0</span> <span class="nv">seconds</span>
    <span class="mi">7321</span> [<span class="nv">Thread</span><span class="o">-</span><span class="mi">2</span>] <span class="nv">INFO</span> <span class="nv">org</span>.<span class="nv">apache</span>.<span class="nv">camel</span>.<span class="nv">impl</span>.<span class="nv">converter</span>.<span class="nv">DefaultTypeConverter</span> <span class="o">-</span> <span class="nv">TypeConverterRegistry</span> <span class="nv">utilization</span>[<span class="nv">attempts</span><span class="o">=</span><span class="mi">2</span>, <span class="nv">hits</span><span class="o">=</span><span class="mi">2</span>, <span class="nv">misses</span><span class="o">=</span><span class="mi">0</span>, <span class="nv">failures</span><span class="o">=</span><span class="mi">0</span>] <span class="nv">mappings</span>[<span class="nv">total</span><span class="o">=</span><span class="mi">170</span>, <span class="nv">misses</span><span class="o">=</span><span class="mi">0</span>]
    <span class="mi">7322</span> [<span class="nv">Thread</span><span class="o">-</span><span class="mi">2</span>] <span class="nv">INFO</span> <span class="nv">org</span>.<span class="nv">apache</span>.<span class="nv">camel</span>.<span class="nv">impl</span>.<span class="nv">DefaultCamelContext</span> <span class="o">-</span> <span class="nv">Apache</span> <span class="nv">Camel</span> <span class="mi">2</span>.<span class="mi">10</span>.<span class="mi">0</span> <span class="ss">(</span><span class="nv">CamelContext</span>: <span class="nv">camel</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">shutdown</span> <span class="nv">in</span> <span class="mi">0</span>.<span class="mi">010</span> <span class="nv">seconds</span>. <span class="k">Uptime</span> <span class="mi">7</span>.<span class="mi">053</span> <span class="nv">seconds</span>.
</code></pre></div>

<p>So that's our first taste of Camel ride! However, we titled this section as "Hello World!" demo, and yet we haven't seen any. But you might have also noticed that above script are mostly boiler plate code that we setup. No user logic has been added yet. Not even the logging the message part! We simply configuring the route.</p>
<p>Now let's modify the script little bit so we will actually add our user logic to process the timer message.</p>
<div class="highlight"><pre><span></span><code>    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.apache.camel:camel-core:2.10.0&#39;</span><span class="p">)</span>
    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.slf4j:slf4j-simple:1.6.6&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.impl.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.builder.</span><span class="o">*</span>

    <span class="k">def</span> <span class="nf">camelContext</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DefaultCamelContext</span><span class="p">()</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">addRoutes</span><span class="p">(</span><span class="n">new</span> <span class="n">RouteBuilder</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">def</span> <span class="nf">void</span> <span class="n">configure</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">from</span><span class="p">(</span><span class="s2">&quot;timer://jdkTimer?period=3000&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;log://camelLogger?level=INFO&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">new</span> <span class="n">Processor</span><span class="p">()</span> <span class="p">{</span>
                    <span class="k">def</span> <span class="nf">void</span> <span class="n">process</span><span class="p">(</span><span class="n">Exchange</span> <span class="n">exchange</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">println</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">})</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">addShutdownHook</span><span class="p">{</span> <span class="n">camelContext</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span> <span class="p">}</span>
    <span class="n">synchronized</span><span class="p">(</span><span class="n">this</span><span class="p">){</span> <span class="n">this</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="p">}</span>
</code></pre></div>

<p>Notice how I can simply append the process code part right after the <code>to("log...")</code> line. I have added a "processor" code block to process the timer message. The logic is simple: we greet the world on each tick.</p>
<h2>Making Camel route more concise and practical</h2>
<p>Now, do I have you at Hello yet? If not, then I hope you will be patient and continue to follow along for few more practical features of Camel. First, if you were to put Camel in real use, I would recommend you setup your business logic separately from the workflow route definition. This is so that you can clearly express and see your entire pipeflow of route at a glance. To do this, you want to move the "processor", into a service bean.</p>
<div class="highlight"><pre><span></span><code>    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.apache.camel:camel-core:2.10.0&#39;</span><span class="p">)</span>
    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.slf4j:slf4j-simple:1.6.6&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.impl.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.builder.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.util.jndi.</span><span class="o">*</span>

    <span class="k">class</span> <span class="nc">SystemInfoService</span> <span class="p">{</span>
        <span class="k">def</span> <span class="nf">void</span> <span class="n">run</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">println</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">def</span> <span class="nf">jndiContext</span> <span class="o">=</span> <span class="n">new</span> <span class="n">JndiContext</span><span class="p">();</span>
    <span class="n">jndiContext</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;systemInfoPoller&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">SystemInfoService</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">camelContext</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DefaultCamelContext</span><span class="p">(</span><span class="n">jndiContext</span><span class="p">)</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">addRoutes</span><span class="p">(</span><span class="n">new</span> <span class="n">RouteBuilder</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">def</span> <span class="nf">void</span> <span class="n">configure</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">from</span><span class="p">(</span><span class="s2">&quot;timer://jdkTimer?period=3000&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;log://camelLogger?level=INFO&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;bean://systemInfoPoller?method=run&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">addShutdownHook</span><span class="p">{</span> <span class="n">camelContext</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span> <span class="p">}</span>
    <span class="n">synchronized</span><span class="p">(</span><span class="n">this</span><span class="p">){</span> <span class="n">this</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="p">}</span>
</code></pre></div>

<p>Now, see how compact this workflow route has become? The Camel's Java DSL such as <code>"from().to().to()"</code> for defining route are so clean and simple to use. You can even show this code snip to your Business Analysts, and they would likely be able to verify your business flow easily! Wouldn't that alone worth a million dollars?</p>
<h1>How about another demo: FilePoller Processing</h1>
<p>File polling processing is a very common and effective way to solve many business problems. If you work for commercial companies long enough, you might have written one before. A typical file poller would process incoming files from a directory and then process the content, and then move the file into a output directory. Let's make a Camel route to do just that.</p>
<div class="highlight"><pre><span></span><code>    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.apache.camel:camel-core:2.10.0&#39;</span><span class="p">)</span>
    <span class="nd">@Grab</span><span class="p">(</span><span class="s1">&#39;org.slf4j:slf4j-simple:1.6.6&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.impl.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.builder.</span><span class="o">*</span>
    <span class="kn">import</span> <span class="nn">org.apache.camel.util.jndi.</span><span class="o">*</span>

    <span class="k">class</span> <span class="nc">UpperCaseTextService</span> <span class="p">{</span>
        <span class="k">def</span> <span class="nf">String</span> <span class="n">transform</span><span class="p">(</span><span class="n">String</span> <span class="n">text</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">toUpperCase</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">def</span> <span class="nf">jndiContext</span> <span class="o">=</span> <span class="n">new</span> <span class="n">JndiContext</span><span class="p">();</span>
    <span class="n">jndiContext</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;upperCaseTextService&quot;</span><span class="p">,</span> <span class="n">new</span> <span class="n">UpperCaseTextService</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">dataDir</span> <span class="o">=</span> <span class="s2">&quot;/$</span><span class="si">{System.properties[&#39;user.home&#39;]}</span><span class="s2">/test/file-poller-demo&quot;</span>
    <span class="k">def</span> <span class="nf">camelContext</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DefaultCamelContext</span><span class="p">(</span><span class="n">jndiContext</span><span class="p">)</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">addRoutes</span><span class="p">(</span><span class="n">new</span> <span class="n">RouteBuilder</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">def</span> <span class="nf">void</span> <span class="n">configure</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">from</span><span class="p">(</span><span class="s2">&quot;file://$</span><span class="si">{dataDir}</span><span class="s2">/in&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;log://camelLogger&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;bean://upperCaseTextService?method=transform&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;file://$</span><span class="si">{dataDir}</span><span class="s2">/out&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">camelContext</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">addShutdownHook</span><span class="p">{</span> <span class="n">camelContext</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span> <span class="p">}</span>
    <span class="n">synchronized</span><span class="p">(</span><span class="n">this</span><span class="p">){</span> <span class="n">this</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="p">}</span>    
</code></pre></div>

<p>Here you see I defined a route to poll a <code>$HOME/test/file-poller-demo/in</code> directory for text files. Once it's found it will log it to console, and then process by a service that transform the content text into upper case. After this, it will send the file into <code>$HOME/test/file-poller-demo/out</code> directory. My goodness, reading the Camel route above probably express what I wrote down just as effective. Do you see the benefits here?</p>
<h2>What's the "batteries" included part.</h2>
<p>If you've used Python programming before, you might have heard the pharase that they claim often: Python has "batteries" included. This means their interpreter comes with a rich of libaries for most of the common programming need. You can often write python program without have to download separated external libraries.</p>
<p>I am making similar analogies here with Apache Camel. The Camel project comes with so many ready to use <a href="http://camel.apache.org/components.html">components</a> that you can find just about any transport protocals that can carry data. These Camel "components" are ones that support different 'Endpoint URI' that we have seen in our demos above. We have simply shown you <code>timer</code>, <code>log</code>, <code>bean</code>, and <code>file</code> components, but there are over 120 more. You will find <code>jms</code>, <code>http</code>, <code>ftp</code>, <code>cfx</code>, or <code>tcp</code>  just to name a few.</p>
<p>The Camel project also has an option for you to define route in <a href="http://camel.apache.org/spring.html">declarative xml format</a>. The xml is just an extension of a Spring xml config with Camel's namespace handler added on top. Spring is optional in Camel, but you can use it together in a very powerful way.</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://zemian.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>